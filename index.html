<!DOCTYPE html>
<html lang="my">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>ğŸ“Š Advanced Income & Expense Tracker</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    
    <script src="https://pl28343252.effectivegatecpm.com/b0/32/35/b0323521ab92aa35ff4ce77822b78adc.js"></script>
    <script src="https://pl28344759.effectivegatecpm.com/eb/25/40/eb25401554277dcd898bb0414f0023b0.js"></script>

    <style>
        /* á€¡á€Ÿá€±á€¬á€„á€ºá€¸á€¡á€á€­á€¯á€„á€ºá€¸á€‘á€¬á€¸á€›á€¾á€­á€á€Šá€º */
        * { margin: 0; padding: 0; box-sizing: border-box; -webkit-tap-highlight-color: transparent; }
        body { font-family: 'Segoe UI', sans-serif; background: #f0f2f5; min-height: 100vh; padding-bottom: 80px; }
        .app-header { background: linear-gradient(135deg, #1a2a6c, #b21f1f, #fdbb2d); color: white; padding: 20px; display: flex; align-items: center; gap: 15px; box-shadow: 0 4px 10px rgba(0,0,0,0.1); }
        .profile-photo { width: 55px; height: 55px; border-radius: 50%; background: rgba(255,255,255,0.2); border: 2px solid white; display: flex; align-items: center; justify-content: center; font-size: 28px; }
        .tabs { display: flex; background: white; position: sticky; top: 0; z-index: 1000; overflow-x: auto; box-shadow: 0 2px 5px rgba(0,0,0,0.05); }
        .tab { flex: 1; min-width: 80px; padding: 12px 5px; text-align: center; cursor: pointer; color: #777; font-weight: bold; font-size: 11px; border-bottom: 3px solid transparent; transition: 0.3s; }
        .tab.active { color: #b21f1f; border-bottom-color: #b21f1f; background: #fff5f5; }
        .tab-icon { display: block; font-size: 20px; margin-bottom: 3px; }
        .content { padding: 15px; }
        .page { display: none; }
        .page.active { display: block; animation: fadeIn 0.4s ease; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
        .card { background: white; padding: 15px; border-radius: 15px; box-shadow: 0 4px 12px rgba(0,0,0,0.05); margin-bottom: 15px; border: 1px solid #eee; }
        .form-group { margin-bottom: 15px; }
        label { display: block; margin-bottom: 6px; font-weight: 600; font-size: 13px; color: #444; }
        input, select { width: 100%; padding: 12px; border: 1.5px solid #ddd; border-radius: 10px; font-size: 15px; outline: none; }
        .btn { width: 100%; padding: 14px; background: linear-gradient(135deg, #1a2a6c, #b21f1f); color: white; border: none; border-radius: 12px; font-weight: bold; cursor: pointer; font-size: 16px; box-shadow: 0 4px 15px rgba(178, 31, 31, 0.3); }
        .balance-hero { background: linear-gradient(135deg, #1a2a6c, #b21f1f); color: white; padding: 30px 20px; border-radius: 20px; text-align: center; margin-bottom: 20px; }
        
        /* Modal Design */
        .modal { display:none; position:fixed; top:0; left:0; width:100%; height:100%; background:rgba(0,0,0,0.8); z-index:10000; justify-content:center; align-items:center; }
        .modal-content { background:white; width:90%; border-radius:20px; padding:25px; text-align:center; }
        .delete-btn { color: #f44336; border: none; background: none; font-size: 18px; cursor: pointer; padding: 5px; }
        .ad-slot-box { margin: 15px 0; min-height: 100px; background: #f9f9f9; border-radius: 10px; border: 1px dashed #ccc; display:flex; align-items:center; justify-content:center; overflow:hidden; }
    </style>
</head>
<body onclick="enableBackBlock()">

    <div class="app-header">
        <div class="profile-photo">ğŸ‘¤</div>
        <div>
            <div id="headName" style="font-weight: bold; font-size: 18px;">User Name</div>
            <div id="headCode" style="font-size: 12px; opacity: 0.9;">CODE: EMP001</div>
        </div>
    </div>

    <div class="tabs">
        <div class="tab active" onclick="showPage('income', this)"><span class="tab-icon">ğŸ’°</span><span class="t-income">á€á€„á€ºá€„á€½á€±</span></div>
        <div class="tab" onclick="showPage('expense', this)"><span class="tab-icon">ğŸ’¸</span><span class="t-expense">á€‘á€½á€€á€ºá€„á€½á€±</span></div>
        <div class="tab" onclick="showPage('history', this)"><span class="tab-icon">ğŸ“œ</span><span class="t-history">á€™á€¾á€á€ºá€á€™á€ºá€¸</span></div>
        <div class="tab" onclick="showPage('weekly', this)"><span class="tab-icon">ğŸ“…</span><span class="t-weekly">15á€›á€€á€º</span></div>
        <div class="tab" onclick="showPage('balance', this)"><span class="tab-icon">ğŸ§®</span><span class="t-balance">á€œá€€á€ºá€€á€»á€”á€º</span></div>
        <div class="tab" onclick="showPage('graph', this)"><span class="tab-icon">ğŸ“Š</span><span class="t-graph">á€‚á€›á€•á€º</span></div>
        <div class="tab" onclick="showPage('profile', this)"><span class="tab-icon">ğŸ‘¤</span><span class="t-profile">Profile</span></div>
    </div>

    <div class="content">
        <div id="income" class="page active">
            <div class="card">
                <div class="form-group"><label>ğŸ“… <span class="t-date">á€›á€€á€ºá€…á€½á€²</span></label><input type="date" id="iDate"></div>
                <div class="form-group"><label>â° <span class="t-hours">á€¡á€œá€¯á€•á€ºá€á€»á€­á€”á€º (á€”á€¬á€›á€®)</span></label><input type="number" id="iHours" value="8"></div>
                <div class="form-group"><label>â±ï¸ OT (á€”á€¬á€›á€®)</label><input type="number" id="iOt" value="0"></div>
                <div class="form-group"><label>ğŸ“… <span class="t-bonus">á€›á€€á€ºá€™á€¾á€”á€ºá€€á€¼á€±á€¸</span></label><input type="number" id="iBonus" value="0"></div>
                <div class="form-group"><label>ğŸ’µ <span class="t-extra">á€¡á€•á€­á€¯á€á€„á€ºá€„á€½á€±</span></label><input type="number" id="iExtra" value="0"></div>
                <button class="btn" onclick="saveData('income')">ğŸ’¾ <span class="t-save">á€á€­á€™á€ºá€¸á€™á€Šá€º</span></button>
            </div>
        </div>

        <div id="expense" class="page">
            <div class="card">
                <div class="form-group"><label>ğŸ“… <span class="t-date">á€›á€€á€ºá€…á€½á€²</span></label><input type="date" id="eDate"></div>
                <div class="form-group">
                    <label>ğŸ“‚ <span class="t-where">á€¡á€™á€»á€­á€¯á€¸á€¡á€…á€¬á€¸</span></label>
                    <select id="eCat" onchange="checkCustom(this.value)">
                        <option value="á€¡á€­á€™á€ºá€œá€">ğŸ  á€¡á€­á€™á€ºá€œá€</option>
                        <option value="á€á€›á€®á€¸á€…á€›á€­á€á€º">ğŸš— á€á€›á€®á€¸á€…á€›á€­á€á€º</option>
                        <option value="á€™á€¯á€”á€·á€ºá€–á€­á€¯á€¸">ğŸœ á€™á€¯á€”á€·á€ºá€–á€­á€¯á€¸</option>
                        <option value="á€¡á€‘á€½á€±á€‘á€½á€±">ğŸ“¦ á€¡á€‘á€½á€±á€‘á€½á€±</option>
                        <option value="custom">â• á€¡á€á€¼á€¬á€¸</option>
                    </select>
                    <input type="text" id="customCat" placeholder="..." style="display:none; margin-top:10px;">
                </div>
                <div class="form-group"><label>ğŸ’µ <span class="t-amount">á€•á€™á€¬á€</span></label><input type="number" id="eAmount"></div>
                <button class="btn" onclick="saveData('expense')">ğŸ’¾ <span class="t-save">á€á€­á€™á€ºá€¸á€™á€Šá€º</span></button>
            </div>
        </div>

        <div id="history" class="page"><div id="historyList"></div></div>
        <div id="weekly" class="page">
            <button class="btn" style="background: #333; margin-bottom:15px;" onclick="askDeleteAll()">ğŸ—‘ï¸ <span class="t-clear">á€…á€¬á€›á€„á€ºá€¸á€¡á€¬á€¸á€œá€¯á€¶á€¸á€–á€»á€€á€ºá€™á€Šá€º</span></button>
            <div id="weeklyList"></div>
        </div>
        
        <div id="balance" class="page">
            <div class="balance-hero">
                <div class="t-balance">á€œá€€á€ºá€€á€»á€”á€ºá€„á€½á€± á€…á€¯á€…á€¯á€•á€±á€«á€„á€ºá€¸</div>
                <h1 id="totalBal" style="font-size: 42px; margin: 5px 0;">0à¸¿</h1>
                <div style="font-size: 14px; background: rgba(0,0,0,0.2); display: inline-block; padding: 5px 15px; border-radius: 20px;"><span class="t-workday">á€¡á€œá€¯á€•á€ºá€†á€„á€ºá€¸á€›á€€á€º</span>: <span id="workCount">0</span> <span class="t-day">á€›á€€á€º</span></div>
            </div>
            <div id="breakdownList" class="card"></div>
        </div>
        <div id="graph" class="page"><div class="card"><canvas id="myChart"></canvas></div></div>
        <div id="profile" class="page">
             <div class="card">
                <div class="form-group"><label class="t-pname">á€¡á€™á€Šá€º</label><input type="text" id="pName"></div>
                <div class="form-group"><label class="t-pcode">á€€á€¯á€á€ºá€”á€¶á€•á€«á€á€º</label><input type="text" id="pCode"></div>
                <div class="form-group"><label class="t-pwage">á€á€”á€±á€·á€œá€¯á€•á€ºá€¡á€¬á€¸á€</label><input type="number" id="pWage"></div>
                <div class="form-group"><label class="t-pot">OT á€”á€¬á€›á€®á€</label><input type="number" id="pOt"></div>
                <button class="btn" onclick="saveProfile()">ğŸ’¾ <span class="t-save">á€á€­á€™á€ºá€¸á€™á€Šá€º</span></button>
            </div>
        </div>
    </div>

    <div id="deleteConfirmModal" class="modal">
        <div class="modal-content">
            <h2 style="color:#b21f1f;">á€–á€»á€€á€ºá€›á€”á€º á€á€±á€á€»á€¬á€•á€«á€á€œá€¬á€¸?</h2>
            <div class="ad-slot-box">á€€á€¼á€±á€¬á€ºá€„á€¼á€¬á€”á€±á€›á€¬</div>
            <div style="display:flex; gap:10px; margin-top:20px;">
                <button class="btn" style="background:#f44336; flex:1;" onclick="executeDelete()">á€–á€»á€€á€ºá€™á€Šá€º</button>
                <button class="btn" style="background:#888; flex:1;" onclick="closeModal('deleteConfirmModal')">á€™á€–á€»á€€á€ºá€•á€«</button>
            </div>
        </div>
    </div>

    <div id="successModal" class="modal">
        <div class="modal-content">
            <div style="font-size: 50px;">âœ…</div>
            <h2>á€á€­á€™á€ºá€¸á€†á€Šá€ºá€¸á€•á€¼á€®á€¸á€•á€«á€•á€¼á€®</h2>
            <button class="btn" style="background:#4CAF50; margin-top:15px;" onclick="closeModal('successModal')">á€¡á€­á€¯á€€á€±</button>
        </div>
    </div>

    <script>
        let records = JSON.parse(localStorage.getItem('f_recs')) || [];
        let profile = JSON.parse(localStorage.getItem('f_prof')) || { name:'User', code:'EMP001', wage:375, ot:69, lang:'my' };
        let deleteId = null;

        // Custom Delete Functions
        function askDelete(id) {
            deleteId = id;
            document.getElementById('deleteConfirmModal').style.display = 'flex';
        }

        function askDeleteAll() {
            deleteId = 'ALL';
            document.getElementById('deleteConfirmModal').style.display = 'flex';
        }

        function executeDelete() {
            if(deleteId === 'ALL') {
                records = [];
            } else {
                records = records.filter(r => r.id !== deleteId);
            }
            localStorage.setItem('f_recs', JSON.stringify(records));
            renderList('historyList', records);
            renderList('weeklyList', records);
            closeModal('deleteConfirmModal');
            if(document.getElementById('balance').classList.contains('active')) updateBalance();
        }

        function closeModal(id) { document.getElementById(id).style.display = 'none'; }

        // renderList á€€á€­á€¯ update á€œá€¯á€•á€ºá€á€¼á€„á€ºá€¸ (onclick="askDelete")
        function renderList(target, data) {
            const div = document.getElementById(target); div.innerHTML = "";
            data.sort((a,b)=>new Date(b.date)-new Date(a.date)).forEach(r => {
                const isInc = r.type==='income';
                div.innerHTML += `<div class="card" style="display:flex; justify-content:space-between; align-items:center; border-left:5px solid ${isInc?'#4CAF50':'#F44336'}">
                    <div><b>${r.date}</b><br><small>${r.category}</small></div>
                    <div style="text-align:right">
                        <div style="font-weight:bold; color:${isInc?'#4CAF50':'#F44336'}">${isInc?'+':'-'}${r.amt.toFixed(0)}à¸¿</div>
                        <button class="delete-btn" onclick="askDelete(${r.id})">ğŸ—‘ï¸</button>
                    </div>
                </div>`;
            });
        }

        // á€€á€»á€”á€ºá€á€²á€· Function á€™á€»á€¬á€¸ (saveData, showPage, etc.) á€¡á€Ÿá€±á€¬á€„á€ºá€¸á€¡á€á€­á€¯á€„á€ºá€¸ á€‘á€¬á€¸á€”á€­á€¯á€„á€ºá€•á€«á€á€šá€º
        function showPage(id, btn) {
            document.querySelectorAll('.page, .tab').forEach(el => el.classList.remove('active'));
            document.getElementById(id).classList.add('active');
            if(btn) btn.classList.add('active');
            if(id === 'balance') updateBalance();
            if(id === 'history' || id === 'weekly') renderList(id+'List', records);
        }

        function saveData(type) {
            const date = document.getElementById(type==='income'?'iDate':'eDate').value;
            if(!date) return alert("á€›á€€á€ºá€…á€½á€²á€›á€½á€±á€¸á€•á€«");
            let amt = 0, cat = "";
            if(type === 'income') {
                amt = (parseFloat(document.getElementById('iHours').value)/8 * profile.wage) + (parseFloat(document.getElementById('iOt').value) * profile.ot) + parseFloat(document.getElementById('iBonus').value) + parseFloat(document.getElementById('iExtra').value);
                cat = "á€á€„á€ºá€„á€½á€±";
            } else {
                amt = parseFloat(document.getElementById('eAmount').value);
                cat = (document.getElementById('eCat').value === 'custom') ? document.getElementById('customCat').value : document.getElementById('eCat').value;
            }
            records.push({ id:Date.now(), type, date, amt, category:cat });
            localStorage.setItem('f_recs', JSON.stringify(records));
            document.getElementById('successModal').style.display = 'flex';
        }

        function updateBalance() {
            const inc = records.filter(r=>r.type==='income').reduce((a,b)=>a+b.amt, 0);
            const exp = records.filter(r=>r.type==='expense').reduce((a,b)=>a+b.amt, 0);
            document.getElementById('totalBal').innerText = (inc - exp).toFixed(0) + 'à¸¿';
        }

        window.onload = () => {
            document.getElementById('iDate').valueAsDate = new Date();
            document.getElementById('eDate').valueAsDate = new Date();
            updateBalance();
        };
    </script>
</body>
                                                                                          </html>
